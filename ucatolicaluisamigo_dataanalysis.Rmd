---
title: "Data analysis Ucatolica Luis Amigo production"
author: "Sebastian Robledo"
date: "1/25/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Creating the environment

```{r}
library(tidyverse)
library(tidygraph)
library(igraph)
```


# Getting data 

```{r}
papers <- 
  read_csv("https://docs.google.com/spreadsheets/d/17b_d24WF2dRBedatAqgArWodAaAn6-o0/export?format=csv&gid=1924642330") |> 
  filter(ano > 2014)

papers |> glimpse()
```


# Academic social network

There is a mistake creating the ASN, there are researchers that not add the co-authors. For example, id = 1 has one author but the paper presents 3 (http://publicaciones.unaula.edu.co/index.php/VisionContable/article/view/1288). We will work with this data, and later, we will organize this issue. 

```{r}
authors_sep <-  papers |> 
  select(id, autores) |> 
  separate_rows(autores, sep = ", ")
```

```{r}
authors_isolated <- 
  authors_sep |> 
  count(id) |> 
  filter(n == 1) |> 
  select(id) |> 
  pull()

authors_ASN <- 
  authors_sep |> 
  filter(!(id %in% authors_isolated))

id_list <- authors_ASN |> 
  select(id) |> 
  pull()

authors_edgelist <- tibble()

for (i in id_list) {
  df_1 = authors_ASN |> filter(id == i)
  df_2 = combn(df_1 |> select(autores) |> pull(), 2, simplify = FALSE)
  df_3 = data.frame(t(data.frame(df_2)), i)
  colnames(df_3) = c("Source", "Target", "id")
  authors_edgelist = authors_edgelist |> bind_rows(df_3)
  
}


authors_graph <- 
  graph_from_data_frame(authors_edgelist,directed = FALSE)
  
```

